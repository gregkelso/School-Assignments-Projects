<html>
<head>
    <!-- Bootstrap imports -->
    <link rel="stylesheet" href="libs/bootstrapCSS.min.css">
    <script src="libs/jquery.js"></script>
    <script src="libs/bootstrap.min.js"></script>
    <!-- THREE.js imports -->    
	<script src="libs/three.js"></script>
	<script src="libs/threex.keyboardstate.js"></script>
    <script src="libs/OrbitControls.js"></script>
</head>
<body>
<!-- Modal -->
<!-- Menu -->
<div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
         Modal content 
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">asdfasdfasdf</h4>
            </div>
            <div class="modal-body">
                <table style="width: 100%">
                    <tr>
                        <td>gjl5;jels;k</td>
                        <td>5lgjsel;rgjsl;j</td>
                    </tr>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<script>
    // Load controls screen
    $(document).ready(function() {
        $('#myModal').modal('show');
    });
        
	var camera, scene, renderer, keyboard, controls;
    
    init();
    animate();
    
    function createBlocks() {
        // Block geo/mat
        var blockGeo = new THREE.BoxGeometry(10, 10, 10);
        var blockMat = new THREE.MeshNormalMaterial();
        
        var outlineMat = new THREE.MeshBasicMaterial({color: 0x000000, side: THREE.BackSide});
        
        // Create the blocks
        var block1 = new THREE.Mesh(blockGeo, blockMat);
        var out1 = new THREE.Mesh(blockGeo, outlineMat);
        out1.scale.multiplyScalar(1.05);
        scene.add(block1);
        scene.add(out1);
        var block2 = new THREE.Mesh(blockGeo, blockMat);
        var out2 = new THREE.Mesh(blockGeo, outlineMat);
        out2.scale.multiplyScalar(1.05);
        scene.add(block2);
        scene.add(out2);
        var block3 = new THREE.Mesh(blockGeo, blockMat);
        var out3 = new THREE.Mesh(blockGeo, outlineMat);
        out3.scale.multiplyScalar(1.05);
        scene.add(block3);
        scene.add(out3);
        var block4 = new THREE.Mesh(blockGeo, blockMat);
        var out4 = new THREE.Mesh(blockGeo, outlineMat);
        out4.scale.multiplyScalar(1.05);
        scene.add(block4);
        scene.add(out4);
        var block5 = new THREE.Mesh(blockGeo, blockMat);
        var out5 = new THREE.Mesh(blockGeo, outlineMat);
        out5.scale.multiplyScalar(1.05);
        scene.add(block5);
        scene.add(out5);
        var block6 = new THREE.Mesh(blockGeo, blockMat);
        var out6 = new THREE.Mesh(blockGeo, outlineMat);
        out6.scale.multiplyScalar(1.05);
        scene.add(block6);
        scene.add(out6);
        var block7 = new THREE.Mesh(blockGeo, blockMat);
        var out7 = new THREE.Mesh(blockGeo, outlineMat);
        out7.scale.multiplyScalar(1.05);
        scene.add(block7);
        scene.add(out7);
        var block8 = new THREE.Mesh(blockGeo, blockMat);
        var out8 = new THREE.Mesh(blockGeo, outlineMat);
        out8.scale.multiplyScalar(1.05);
        scene.add(block8);
        scene.add(out8);
        var block9 = new THREE.Mesh(blockGeo, blockMat);
        var out9 = new THREE.Mesh(blockGeo, outlineMat);
        out9.scale.multiplyScalar(1.05);
        scene.add(block9);
        scene.add(out9);
        
        // Position the blocks
        block1.position.set(-10, 10, 0);
        out1.position.set(-10, 10, 0);
        block2.position.set(0, 10, 0);
        out2.position.set(0, 10, 0);
        block3.position.set(10, 10, 0);
        out3.position.set(10, 10, 0);
        block4.position.set(-10, 0, 0);
        out4.position.set(-10, 0, 0);
        block5.position.set(0, 0, 5);
        out5.position.set(0, 0, 5);
        block6.position.set(10, 0, 0);
        out6.position.set(10, 0, 0);
        block7.position.set(-10, -10, 0);
        out7.position.set(-10, -10, 0);
        block8.position.set(0, -10, 0);
        out8.position.set(0, -10, 0);
        block9.position.set(10, -10, -2.5);
        out9.position.set(10, -10, -2.5);
    }
    
	function init()
	{
		keyboard = new THREEx.KeyboardState();
		scene = new THREE.Scene();
        
        
        // Add blocks
        createBlocks();

		camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.1, 20000 );
        scene.add(camera);
        camera.position.set(0, -60, 40);
		camera.lookAt( scene.position );
        camera.up.set(0,0,1); // <<<------------------- THIS ALLOWS ROTATING AROUND Z AXIS W/ ORBITCONTROLS

		renderer = new THREE.WebGLRenderer();
		renderer.setClearColor( 0x6fa79a, 1.0 );
		renderer.setSize( window.innerWidth, window.innerHeight );
		renderer.shadowMapEnabled = true;

        var spotLight = new THREE.SpotLight(0xffffff);
        spotLight.position.set(20, -80, 60);
        spotLight.castShadow = true;
        spotLight.lookAt(scene.position);
        scene.add(spotLight);
		
        var ambLight = new THREE.AmbientLight( 0x000000 ); // soft white light
        scene.add(ambLight);
        
        controls = new THREE.OrbitControls( camera, renderer.domElement );
        controls.addEventListener( 'change', render );
        
		document.body.appendChild( renderer.domElement );		
		render();
        animate();
	}

    function animate() {
        requestAnimationFrame( animate );
        renderer.render( scene, camera );
        controls.update();
    }
    
	function render()
	{
        // Handle kayboard input
        if (keyboard.pressed("p")) {
            $('#myModal').modal('show');
        }
		renderer.render( scene, camera );
	}
</script>
</body>
</html>
